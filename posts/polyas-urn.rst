.. title: Pólya's Urn
.. slug: polyas-urn
.. date: 2014-07-25 17:24:37 UTC
.. tags: mathjax, probability
.. link: 
.. description: 
.. type: text

Balls in Urns
=============

If you have studied probability, you are probably familiar with the canonical balls-in-an-urn allegory for understanding discrete probability distributions.
For example, you could imagine an urn containing 1 red ball and 3 green balls.
Drawing a ball from the urn at random represents sampling from a probability distribution where the probability of one outcome is 25%, and the probability of the other outcome is 75%.
We can extend this idea in a variety of ways.


Pólya's Urn
===========

In *Pólya's Urn*, the extension is that whenever you draw a ball from the urn, you not only replace it, but you add an extra ball of the same colour.
So if you happened to draw a green ball in the example above, then the ratio would change from 1:3 to 1:4.
That means on the next draw, you would now have only a 20% chance of drawing red.
On the other hand, if you happened to have drawn red, then the ratio would change to 2:3, giving red a probability of 40%/

This process is interesting, because it has the property that the more often you observe something, the more likely you are to observe it again.

The effect of different starting conditions
===========================================

Let's imagine the simplest case, in which we start with one each of two colours, red and green, and think about the probability and effects of the first three draws:

+------+-------------+---------+
| Draw |  p(Draw)    | new R:G |
+======+=============+=========+
| R    | :math:`1/2` | 2:1     |
+------+-------------+---------+
| R    | :math:`2/3` | 3:1     |
+------+-------------+---------+
| R    | :math:`3/4` | 4:1     |
+------+-------------+---------+
|      |             |         |
+------+-------------+---------+
| R    | :math:`1/2` | 2:1     |
+------+-------------+---------+
| R    | :math:`2/3` | 3:1     |
+------+-------------+---------+
| G    | :math:`1/4` | 3:2     |
+------+-------------+---------+


R      :math:`1/2`   2:1
R      :math:`2/3`   3:1
G      :math:`1/4`   3:2
===== ============= ========
R      :math:`1/2`   2:1
G      :math:`1/3`   2:2
R      :math:`1/2`   3:2
===== ============= ========
R      :math:`1/2`   2:1
G      :math:`1/3`   2:2
G      :math:`1/2`   2:3
===== ============= ========
G      :math:`1/2`   1:2
R      :math:`1/3`   2:2
R      :math:`1/2`   3:2
===== ============= ========
G      :math:`1/2`   1:2
R      :math:`1/3`   2:2
G      :math:`1/2`   2:3
===== ============= ========
G      :math:`1/2`   1:2
G      :math:`2/3`   1:3
R      :math:`1/4`   2:3
===== ============= ========
G      :math:`1/2`   1:2
G      :math:`2/3`   1:3
G      :math:`3/4`   1:4
===== ============= ========



Inference
=========

We can look at this from the opposite perspective, too.
Suppose you have an urn, and you know the balls in it were generated by the above process, but now the urn is fixed.
Because of the way the distribution of colours was generated,
it is still the case that the more you see a particular colour, the more you should expect to see it.
That's because the result of the process tends to result in a *skewed* distribution, where colour with the most balls has more by a large proportion.

To see this, imagine the simple case of starting with one each of red and green.
No matter what you start with 





Pólya's Urn — Basic
===================

* Random generator of elements of an unordered set.
* Giant urn containing some number of balls of each colour.
* To get a sample, draw from the urn.
* Replace the ball and *add another* of the same colour

**Every observation increases the likelihood of that observation.**


Pólya's Urn — Dirichlet Process
===============================

* Urn intially has one black ball.
* To generate a sample, draw a ball from the urn.

  * As before, except:

    * If we draw black, select a new colour that has never been in the urn.

Alpha
=====

* More generally, start with alpha black balls.
* alpha can be fractional, but breaks analogy.


